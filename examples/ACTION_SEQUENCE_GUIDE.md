# 机械臂动作序列功能使用指南

## 功能概述

新的 `execute_action_sequence` 工具允许 AI 一次性设计并执行完整的动作序列，实现连续流畅的机械臂动作，避免了逐步执行带来的停顿问题。

## 主要特性

1. **一次性设计**：AI 会在开始执行前完整规划所有动作步骤
2. **连续执行**：所有动作连续执行，无需等待每个动作完成后再发送下一个
3. **灵活控制**：支持角度控制、坐标控制、夹爪、吸泵等多种动作类型
4. **精确时序**：每个动作都可以设置速度和持续时间

## 使用方法

### 1. 简单使用

只需告诉 AI 你想要的动作，例如：
- "给我跳个舞"
- "逗逗猫"
- "画个圆"
- "做个按摩动作"

AI 会自动设计并执行相应的动作序列。

### 2. 动作序列结构

```python
{
    "sequence_name": "动作序列名称",
    "actions": [
        # 角度控制
        {"type": "angles", "angles": [45, 60, 30], "speed": 80, "duration": 1.0},
        
        # 坐标控制
        {"type": "coords", "coords": [200, 0, 100], "speed": 60, "duration": 1.5},
        
        # 夹爪控制
        {"type": "gripper", "gripper_action": "open", "speed": 50, "duration": 0.5},
        {"type": "gripper", "gripper_action": "close", "speed": 50, "duration": 0.5},
        
        # 吸泵控制
        {"type": "pump", "pump_action": "on", "duration": 0.3},
        {"type": "pump", "pump_action": "off", "duration": 0.3},
        
        # 等待
        {"type": "wait", "duration": 1.0}
    ],
    "default_interval": 0.5  # 默认动作间隔
}
```

### 3. 参数说明

- **type**: 动作类型
  - `angles`: 控制关节角度
  - `coords`: 控制笛卡尔坐标
  - `gripper`: 控制夹爪
  - `pump`: 控制吸泵
  - `wait`: 等待

- **speed**: 移动速度 (0-200 mm/s)
- **duration**: 动作持续时间（秒）

## 示例场景

### 舞蹈动作
```
用户：给我跳个舞
AI：设计包含左右摇摆、上下律动、旋转等动作的舞蹈序列
```

### 逗猫动作
```
用户：逗逗猫
AI：设计快慢结合、突然变向的逗猫动作序列
```

### 自定义动作
```
用户：做一个打招呼的动作
AI：设计举手、摇摆、点头等拟人化动作序列
```

## 注意事项

1. **安全考虑**：动作幅度要合理，避免极限位置
2. **速度控制**：根据动作类型选择合适的速度
3. **时序安排**：合理设置duration确保动作完成
4. **连贯性**：相邻动作之间要考虑过渡的自然性

## 高级技巧

1. **节奏感**：通过速度变化和停顿创造节奏
2. **表现力**：结合夹爪和吸泵增加动作表现力
3. **复杂动作**：组合多种控制方式实现复杂效果
4. **情感表达**：通过动作速度和幅度表达不同情感

## 与原有功能的对比

| 原有方式 | 新功能 |
|---------|--------|
| 逐步发送指令 | 一次性设计完整序列 |
| 动作间有停顿 | 连续流畅执行 |
| 需要多次交互 | 一次交互完成 |
| 难以保证连贯性 | 自动优化连贯性 |

## 常见问题

**Q: 动作序列最多支持多少个动作？**
A: 理论上没有限制，但建议控制在 20-30 个动作以内，确保执行效果。

**Q: 如何调整动作的流畅度？**
A: 通过调整 speed 和 duration 参数，speed 决定移动快慢，duration 决定停留时间。

**Q: 可以中途停止吗？**
A: 可以使用 emergency_stop 工具紧急停止。

**Q: 如何创造更有创意的动作？**
A: 尝试组合不同类型的动作，利用速度变化，加入适当的停顿和夹爪/吸泵动作。 